<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DivinePoshaks | Ultra Infinity Boutique</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&family=Playfair+Display:ital,wght@0,700;0,900;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

    <style>
        :root { 
            --accent: #6C5CE7; --accent-soft: rgba(108, 92, 231, 0.08); 
            --bg: #F8F9FD; --glass: rgba(255, 255, 255, 0.9); 
            --transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            --radius-ultra: 35px; --gold: #D4AF37;
            --whatsapp: #25D366;
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg); color: #1A1A1A; overflow-x: hidden; letter-spacing: -0.01em; width: 100%; }
        .aurora { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at 10% 10%, var(--accent-soft) 0%, transparent 40%), radial-gradient(circle at 90% 90%, rgba(162, 155, 254, 0.1) 0%, transparent 40%); opacity: 0.6; }

        .glass-nav { background: var(--glass); backdrop-filter: blur(25px); border-bottom: 1px solid rgba(0,0,0,0.03); padding: 12px 0; z-index: 1050; position: sticky; top: 0; }
        .navbar-brand { font-weight: 900; font-family: 'Playfair Display', serif; font-size: 1.6rem; background: linear-gradient(to right, var(--accent), #A29BFE); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .upload-portal-card { background: white; border-radius: 40px; padding: 35px; box-shadow: 0 30px 60px rgba(0,0,0,0.04); border: 1px solid rgba(108, 92, 231, 0.1); position: relative; }
        .upload-preview-box { 
            width: 100%; height: 220px; border-radius: 30px; border: 2px dashed #DDD; 
            display: flex; align-items: center; justify-content: center; overflow: hidden; 
            background: #fdfdff; transition: 0.4s; position: relative; margin-bottom: 20px;
        }
        .upload-preview-box img { width: 100%; height: 100%; object-fit: cover; }
        .upload-icon-label { cursor: pointer; text-align: center; color: #999; }
        .upload-icon-label i { font-size: 3rem; color: var(--accent); margin-bottom: 10px; display: block; }
        
        .luxe-input-group { background: #f8f9fc; border-radius: 20px; border: 2px solid transparent; transition: 0.3s; padding: 10px 18px; margin-bottom: 15px; }
        .luxe-input-group:focus-within { border-color: var(--accent); background: white; box-shadow: 0 10px 25px var(--accent-soft); }
        .luxe-input-group label { font-size: 0.65rem; font-weight: 800; color: var(--accent); text-transform: uppercase; margin-bottom: 2px; display: block; }
        .luxe-input-group input, .luxe-input-group select { border: none; background: transparent; width: 100%; font-weight: 600; font-size: 0.95rem; outline: none; }
        
        .btn-explosive { 
            background: linear-gradient(to right, #6c5ce7, #a29bfe); color: white; 
            border: none; border-radius: 22px; padding: 18px; font-weight: 800; 
            letter-spacing: 1px; transition: 0.4s; box-shadow: 0 15px 30px var(--accent-soft);
        }
        .btn-explosive:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 20px 40px rgba(108, 92, 231, 0.3); }

        /* --- WHATSAPP FLOATING BUTTON --- */
        .whatsapp-float {
            position: fixed; bottom: 100px; right: 20px; background: var(--whatsapp);
            color: white; width: 55px; height: 55px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3);
            z-index: 1000; transition: 0.3s; text-decoration: none;
        }
        .whatsapp-float:hover { transform: scale(1.1); color: white; }

        /* --- REST OF STYLES PRESERVED --- */
        .fest-countdown { background: #1A1A1A; color: white; border-radius: 25px; padding: 15px; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .creative-greeting-wrap { padding: 40px 0 30px; }
        .user-name-shimmer { font-family: 'Plus Jakarta Sans', sans-serif; font-weight: 800; font-size: clamp(2.2rem, 8vw, 3.5rem); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background: linear-gradient(to right, #1a1a1a 20%, var(--accent) 40%, var(--accent) 60%, #1a1a1a 80%); background-size: 200% auto; animation: textShimmer 4s linear infinite, floatY 6s ease-in-out infinite; }
        @keyframes textShimmer { to { background-position: 200% center; } }
        @keyframes floatY { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .cal-container { background: white; border-radius: 40px; padding: 30px; box-shadow: 0 30px 70px rgba(0,0,0,0.04); max-width: 450px; margin: 0 auto; }
        .cal-date.today { background: var(--accent); color: white; }
        .cal-date.sacred { color: #FF4757; background: #FFF0F0; }

        .poshak-card { background: white; border-radius: var(--radius-ultra); border: none; overflow: hidden; transition: var(--transition); height: 100%; position: relative; opacity: 0; cursor: pointer; }
        .poshak-card.visible { opacity: 1; animation: fadeInUp 0.6s var(--transition); }
        .img-wrap { aspect-ratio: 1 / 1.15; overflow: hidden; background: #f0f2f5; }
        .img-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .price-tag { position: absolute; bottom: 15px; right: 15px; background: rgba(255,255,255,0.92); backdrop-filter: blur(10px); color: var(--accent); padding: 5px 12px; border-radius: 12px; font-weight: 800; }
        .luxe-id-tag { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.6); color: white; padding: 2px 8px; border-radius: 6px; font-size: 0.6rem; font-weight: 700; z-index: 5; }

        .action-hub { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: var(--glass); backdrop-filter: blur(25px); padding: 10px 25px; border-radius: 100px; display: flex; gap: 15px; z-index: 1000; }
        .hub-btn { width: 48px; height: 48px; border-radius: 50%; border: none; background: #f1f2f6; color: var(--accent); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .hub-btn.active { background: var(--accent); color: white; }

        .hidden { display: none !important; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="aurora"></div>

    <a href="https://wa.me/917206279351?text=Radhe%20Radhe!%20I%20have%20an%20inquiry%20regarding%20DivinePoshaks." class="whatsapp-float animate__animated animate__bounceInUp" target="_blank">
        <i class="bi bi-whatsapp"></i>
    </a>

    <nav class="navbar navbar-expand glass-nav">
        <div class="container d-flex justify-content-between align-items-center">
            <a class="navbar-brand" href="#" onclick="showSection('shop')">DivinePoshaks</a>
            <div class="d-flex align-items-center gap-3">
                <button id="loginBtn" class="btn btn-dark rounded-pill px-4 fw-800 btn-sm">Login</button>
                <img src="" id="userAvatar" class="hidden shadow-sm" onclick="showSection('profile')" style="width: 38px; height: 38px; border-radius: 12px; cursor: pointer; border: 2px solid var(--accent);">
            </div>
        </div>
    </nav>

    <main id="sectionShop" class="section-container container pb-5 mb-5">
        <header class="creative-greeting-wrap text-center">
            <div id="countdownBox" class="fest-countdown animate__animated animate__fadeIn">
                <div class="text-start ms-2"><small class="fw-bold d-block text-gold">NEXT FESTIVAL</small><span id="cdEventName" class="small fw-800 text-white">...</span></div>
                <div class="d-flex gap-3 ms-auto">
                    <div class="text-center"><span class="cd-val" id="cdDays">00</span><span class="cd-lbl">Days</span></div>
                    <div class="text-center"><span class="cd-val" id="cdHrs">00</span><span class="cd-lbl">Hrs</span></div>
                    <div class="text-center"><span class="cd-val" id="cdMin">00</span><span class="cd-lbl">Min</span></div>
                </div>
            </div>
            <p id="timeGreeting" class="greet-text">Radhe Radhe!</p>
            <h1 id="userGreeting" class="user-name-shimmer">Divine Collections.</h1>
        </header>
        <div id="gallery" class="row g-3 g-md-4"></div>
    </main>

    <main id="sectionCalendar" class="section-container container hidden py-5 mb-5">
        <div class="cal-container animate__animated animate__fadeIn">
            <div class="cal-header">
                <button class="btn btn-light rounded-3" onclick="changeMonth(-1)"><i class="bi bi-chevron-left"></i></button>
                <h3 class="cal-month-title" id="monthDisplay">January</h3>
                <button class="btn btn-light rounded-3" onclick="changeMonth(1)"><i class="bi bi-chevron-right"></i></button>
            </div>
            <div class="cal-grid" id="calGrid"></div>
        </div>
        <div id="insightCard" class="insight-card animate__animated animate__fadeInUp mt-4">
             <span class="tithi-tag" id="insightTithi">Tithi Status</span>
             <h4 id="insightTitle" class="fw-900 mb-2">Divine Almanac</h4>
             <p id="insightDesc" class="text-muted small">Select a date.</p>
        </div>
    </main>

    <main id="sectionAdmin" class="section-container container hidden py-4 mb-5">
        <div class="upload-portal-card animate__animated animate__zoomIn">
            <h4 class="fw-900 mb-4 text-center">Studio Upload Portal</h4>
            
            <div class="upload-preview-box" id="previewPortal">
                <label for="pImg" class="upload-icon-label">
                    <i class="bi bi-cloud-arrow-up-fill"></i>
                    <span class="fw-800">CLICK TO SELECT MASTERPIECE</span>
                </label>
                <img id="uploadPreview" class="hidden">
            </div>
            
            <input type="file" id="pImg" class="hidden" accept="image/*" onchange="handlePreview(this)">

            <div class="row g-2">
                <div class="col-md-6">
                    <div class="luxe-input-group">
                        <label>Poshak Name</label>
                        <input type="text" id="pName" placeholder="e.g. Velvet Vrindavan Blue">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="luxe-input-group">
                        <label>Price Value (â‚¹)</label>
                        <input type="number" id="pPrice" placeholder="599">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="luxe-input-group">
                        <label>Craft Material</label>
                        <select id="pMat">
                            <option value="Woolen">Woolen Handcrafted</option>
                            <option value="Crochet">Crochet Artistic</option>
                            <option value="Velvet">Premium Velvet</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="luxe-input-group">
                        <label>Available Sizes</label>
                        <input type="text" id="pSize" placeholder="e.g. 0, 1, 2">
                    </div>
                </div>
                <button id="uploadBtn" class="btn btn-explosive w-100 mt-3 animate__animated animate__pulse animate__infinite">
                    <i class="bi bi-stars me-2"></i> PUBLISH TO BOUTIQUE
                </button>
            </div>
            <div id="upStatus" class="text-center mt-3 small fw-bold text-accent"></div>
        </div>

        <div class="bg-white p-4 rounded-5 shadow-sm mt-4" onclick="toggleCollapse('inventoryList')">
            <h5 class="fw-900 mb-0">Manage Inventory <i class="bi bi-chevron-down float-end"></i></h5>
            <div id="inventoryList" class="mt-4 hidden" onclick="event.stopPropagation()"><div id="adminInventory"></div></div>
        </div>
    </main>

    <main id="sectionProfile" class="section-container container hidden py-5 mb-5">
        <div class="bg-white p-5 rounded-5 shadow-sm text-center">
            <img src="" id="profImg" class="rounded-circle mb-3 border border-4" style="width: 100px; height: 100px;">
            <h2 id="profName" class="fw-900 mb-1">Devotee</h2>
            <button id="logoutBtn" class="btn btn-outline-danger rounded-pill px-5 mt-4 fw-800">EXIT ACCOUNT</button>
        </div>
    </main>

    <div class="action-hub">
        <button class="hub-btn active" id="hubShop" onclick="showSection('shop')"><i class="fa fa-house-chimney"></i></button>
        <button class="hub-btn" id="hubCalendar" onclick="showSection('calendar')"><i class="bi bi-calendar2-range"></i></button>
        <button class="hub-btn hidden" id="hubAdmin" onclick="showSection('admin')"><i class="bi bi-shield-lock"></i></button>
        <button class="hub-btn hidden" id="hubProfile" onclick="showSection('profile')"><i class="fa fa-user-circle"></i></button>
    </div>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { apiKey: "AIzaSyBTRwFyTODsIj5kPm6Tw0ppdHrBBvYP0a4", authDomain: "shop-c8a3f.firebaseapp.com", databaseURL: "https://shop-c8a3f-default-rtdb.firebaseio.com", projectId: "shop-c8a3f", storageBucket: "shop-c8a3f.firebasestorage.app" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        const provider = new GoogleAuthProvider();
        const adminEmail = "akhilgoel985@gmail.com";
        const whatsappNumber = "917206279351"; // Updated Contact Number

        window.handlePreview = (input) => {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('uploadPreview').src = e.target.result;
                    document.getElementById('uploadPreview').classList.remove('hidden');
                    document.querySelector('.upload-icon-label').classList.add('hidden');
                    document.getElementById('previewPortal').style.border = "none";
                };
                reader.readAsDataURL(input.files[0]);
            }
        };

        document.getElementById('uploadBtn').onclick = async () => {
            const file = document.getElementById('pImg').files[0], name = document.getElementById('pName').value, price = document.getElementById('pPrice').value;
            if(!file || !name) return alert("Select photo and enter name!");
            document.getElementById('upStatus').innerText = "ðŸš€ Publishing Masterpiece...";
            try {
                const compressed = await imageCompression(file, { maxSizeMB: 0.04, maxWidthOrHeight: 600 });
                const reader = new FileReader();
                reader.readAsDataURL(compressed);
                reader.onloadend = async () => {
                    await push(ref(db, 'products'), { name, price, material: document.getElementById('pMat').value, size: document.getElementById('pSize').value, url: reader.result });
                    document.getElementById('upStatus').innerText = "âœ¨ Published Successfully!";
                    setTimeout(() => location.reload(), 1500);
                };
            } catch (e) { alert("Error uploading"); }
        };

        window.orderViaWhatsApp = (name, id, price) => {
            const msg = encodeURIComponent(`Radhe Radhe! I would like to buy:\n\nâœ¨ Poshak: ${name}\nðŸ†” ID: L-${id}\nðŸ’° Price: â‚¹${price}\n\nPlease share availability details.`);
            window.open(`https://wa.me/${whatsappNumber}?text=${msg}`, '_blank');
        };

        const sacredEvents = [{d:"2026-02-15",n:"Maha Shivaratri"},{d:"2026-03-04",n:"Holi"},{d:"2026-03-27",n:"Rama Navami"},{d:"2026-09-04",n:"Krishna Janmashtami"},{d:"2026-11-08",n:"Diwali"}];
        function runCountdown() {
            const now = new Date(); const next = sacredEvents.find(e => new Date(e.d) > now);
            if(!next) return; document.getElementById('cdEventName').innerText = next.n;
            const target = new Date(next.d).getTime();
            setInterval(() => {
                const diff = target - new Date().getTime();
                document.getElementById('cdDays').innerText = Math.floor(diff/(1000*60*60*24)).toString().padStart(2,'0');
                document.getElementById('cdHrs').innerText = Math.floor((diff%(1000*60*60*24))/(1000*60*60)).toString().padStart(2,'0');
                document.getElementById('cdMin').innerText = Math.floor((diff%(1000*60*60))/(1000*60)).toString().padStart(2,'0');
            }, 1000);
        }
        runCountdown();

        let vMonth = new Date().getMonth(), vYear = 2026;
        const tithis = ["Pratipada", "Dwitiya", "Tritiya", "Chaturthi", "Panchami", "Shashti", "Saptami", "Ashtami", "Navami", "Dashami", "Ekadashi", "Dwadashi", "Trayodashi", "Chaturdashi", "Purnima/Amavasya"];
        function renderCal() {
            const grid = document.getElementById('calGrid');
            const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
            document.getElementById('monthDisplay').innerText = months[vMonth];
            grid.innerHTML = '<div class="small fw-800 opacity-50">S</div><div class="small fw-800 opacity-50">M</div><div class="small fw-800 opacity-50">T</div><div class="small fw-800 opacity-50">W</div><div class="small fw-800 opacity-50">T</div><div class="small fw-800 opacity-50">F</div><div class="small fw-800 opacity-50">S</div>';
            const first = new Date(vYear, vMonth, 1).getDay(); const days = new Date(vYear, vMonth + 1, 0).getDate();
            for (let i = 0; i < first; i++) grid.appendChild(document.createElement('div'));
            for (let d = 1; d <= days; d++) {
                const dateDiv = document.createElement('div'); dateDiv.className = 'cal-date'; dateDiv.innerText = d;
                const fKey = `${vYear}-${String(vMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const ev = sacredEvents.find(e => e.d === fKey);
                if(ev) dateDiv.classList.add('sacred');
                if(new Date().toDateString() === new Date(vYear,vMonth,d).toDateString()) dateDiv.classList.add('today');
                dateDiv.onclick = () => {
                    document.getElementById('insightTitle').innerText = `${d} ${months[vMonth]}`;
                    const tithiName = tithis[(d-1)%15];
                    document.getElementById('insightTithi').innerText = `${tithiName} â€¢ ${d%30<=15?"Shukla":"Krishna"} Paksha`;
                    document.getElementById('insightDesc').innerText = ev ? `Festival: ${ev.n}` : "A peaceful day for Devotion.";
                };
                grid.appendChild(dateDiv);
            }
        }
        window.changeMonth = (dir) => { vMonth += dir; if(vMonth<0){vMonth=11;vYear--;} else if(vMonth>11){vMonth=0;vYear++;} renderCal(); };
        renderCal();

        window.showSection = (n) => {
            document.querySelectorAll('.section-container').forEach(s => s.classList.add('hidden'));
            document.getElementById(`section${n.charAt(0).toUpperCase() + n.slice(1)}`).classList.remove('hidden');
            document.querySelectorAll('.hub-btn').forEach(b => b.classList.remove('active'));
            const b = document.getElementById(`hub${n.charAt(0).toUpperCase() + n.slice(1)}`);
            if(b) b.classList.add('active');
            window.scrollTo(0,0);
        };
        window.toggleCollapse = (id) => document.getElementById(id).classList.toggle('hidden');

        onAuthStateChanged(auth, user => {
            if (user) {
                document.getElementById('loginBtn').classList.add('hidden');
                document.getElementById('userAvatar').classList.remove('hidden');
                document.getElementById('userAvatar').src = user.photoURL;
                document.getElementById('profImg').src = user.photoURL;
                document.getElementById('hubProfile').classList.remove('hidden');
                if (user.email === adminEmail) document.getElementById('hubAdmin').classList.remove('hidden');
                onValue(ref(db, `users/${user.uid}`), s => {
                    const d = s.val() || {}; const n = d.name || user.displayName;
                    document.getElementById('profName').innerText = n;
                    updateGreeting(n);
                });
            } else {
                document.getElementById('loginBtn').classList.remove('hidden');
                document.getElementById('userAvatar').classList.add('hidden');
                document.getElementById('hubAdmin').classList.add('hidden');
                document.getElementById('hubProfile').classList.add('hidden');
                updateGreeting(null);
            }
        });

        function updateGreeting(n) {
            const hr = new Date().getHours(); let g = hr<12?"Good Morning":hr<17?"Good Afternoon":"Good Evening";
            document.getElementById('timeGreeting').innerText = n ? `${g},` : "Radhe Radhe,";
            document.getElementById('userGreeting').innerText = n ? `${n}.` : "Divine Boutique.";
        }

        onValue(ref(db, 'products'), snap => {
            const data = snap.val(); window.allItems = data ? Object.entries(data).map(([id, p]) => ({ id, luxeID: id.slice(-4).toUpperCase(), ...p })) : [];
            const gallery = document.getElementById('gallery'); gallery.innerHTML = '';
            const inv = document.getElementById('adminInventory'); if(inv) inv.innerHTML = '';
            window.allItems.forEach((p, index) => {
                gallery.innerHTML += `
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="poshak-card shadow-sm visible" onclick="orderViaWhatsApp('${p.name}', '${p.luxeID}', '${p.price}')">
                            <span class="luxe-id-tag">L-${p.luxeID}</span>
                            <div class="img-wrap"><img src="${p.url}"></div>
                            <div class="p-2 text-center small fw-bold">
                                ${p.name}<br>
                                <span class="text-primary">â‚¹${p.price}</span>
                                <div class="mt-1 text-success" style="font-size: 0.65rem">
                                    <i class="bi bi-whatsapp"></i> Buy via WhatsApp
                                </div>
                            </div>
                        </div>
                    </div>`;
                if(inv) inv.innerHTML += `<div class="p-3 border-bottom d-flex justify-content-between align-items-center"><span><b>${p.name}</b></span><button onclick="remove(ref(db,'products/${p.id}'))" class="btn btn-sm text-danger"><i class="bi bi-trash"></i></button></div>`;
            });
        });

        document.getElementById('loginBtn').onclick = () => signInWithPopup(auth, provider);
        document.getElementById('logoutBtn').onclick = () => signOut(auth);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
