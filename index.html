<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DivinePoshaks | Ultra Infinity Boutique</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&family=Playfair+Display:ital,wght@0,700;0,900;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

    <style>
        :root { 
            --accent: #6C5CE7; --accent-soft: rgba(108, 92, 231, 0.08); 
            --bg: #F8F9FD; --glass: rgba(255, 255, 255, 0.9); 
            --transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            --radius-ultra: 35px;
            --gold: #D4AF37;
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg); color: #1A1A1A; overflow-x: hidden; letter-spacing: -0.01em; width: 100%; }
        .aurora { position: fixed; inset: 0; z-index: -1; background: radial-gradient(circle at 10% 10%, var(--accent-soft) 0%, transparent 40%), radial-gradient(circle at 90% 90%, rgba(162, 155, 254, 0.1) 0%, transparent 40%); opacity: 0.6; }

        .glass-nav { background: var(--glass); backdrop-filter: blur(25px); border-bottom: 1px solid rgba(0,0,0,0.03); padding: 12px 0; z-index: 1050; position: sticky; top: 0; }
        .navbar-brand { font-weight: 900; font-family: 'Playfair Display', serif; font-size: 1.6rem; background: linear-gradient(to right, var(--accent), #A29BFE); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .fest-countdown { background: #1A1A1A; color: white; border-radius: 25px; padding: 15px; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; gap: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .cd-val { font-weight: 800; font-size: 1.2rem; color: var(--accent); display: block; line-height: 1; }
        .cd-lbl { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.6; }

        .creative-greeting-wrap { padding: 40px 0 30px; perspective: 1000px; }
        .greet-text { font-family: 'Playfair Display', serif; font-weight: 700; font-style: italic; color: #666; font-size: 1.2rem; margin-bottom: -5px; opacity: 0.8; }
        .user-name-shimmer { 
            font-family: 'Plus Jakarta Sans', sans-serif; font-weight: 800; font-size: clamp(2.5rem, 8vw, 4rem); 
            letter-spacing: -2px; line-height: 1;
            background: linear-gradient(to right, #1a1a1a 20%, var(--accent) 40%, var(--accent) 60%, #1a1a1a 80%);
            background-size: 200% auto;
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: textShimmer 4s linear infinite, floatY 6s ease-in-out infinite;
        }

        /* --- LUXE SEARCH BAR --- */
        .search-container { max-width: 600px; margin: 0 auto 20px; position: relative; }
        .luxe-search { background: white; border: 1px solid rgba(0,0,0,0.05); padding: 15px 25px 15px 50px; border-radius: 20px; width: 100%; font-weight: 600; font-size: 0.95rem; box-shadow: 0 10px 30px rgba(0,0,0,0.02); transition: 0.4s; outline: none; }
        .luxe-search:focus { box-shadow: 0 15px 40px var(--accent-soft); border-color: var(--accent); }
        .search-icon { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: var(--accent); font-size: 1.2rem; }

        .cal-container { background: white; border-radius: 40px; padding: 35px; box-shadow: 0 30px 70px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); max-width: 500px; margin: 0 auto; }
        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .cal-nav-btn { background: var(--bg); border: none; width: 45px; height: 45px; border-radius: 15px; color: var(--gold); transition: 0.3s; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .cal-nav-btn:hover { background: var(--accent); color: white; transform: scale(1.1); }
        .cal-month-title { font-family: 'Playfair Display', serif; font-weight: 900; font-size: 1.8rem; margin: 0; }
        
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; text-align: center; }
        .cal-day-label { font-size: 0.7rem; font-weight: 800; color: #BBB; padding-bottom: 10px; }
        .cal-date { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 0.95rem; font-weight: 700; border-radius: 16px; cursor: pointer; transition: 0.3s; border: 1px solid transparent; position: relative; }
        .cal-date:hover { background: var(--accent-soft); color: var(--accent); }
        .cal-date.today { background: var(--accent); color: white; box-shadow: 0 10px 20px var(--accent-soft); }
        .cal-date.sacred { background: #FFF0F0; color: #FF4757; border-color: #FFE0E0; }
        .cal-date.selected { border: 2px solid var(--accent); transform: scale(1.1); z-index: 2; }
        .fest-indicator { position: absolute; bottom: 4px; width: 4px; height: 4px; border-radius: 50%; background: #FF4757; }

        .insight-card { background: linear-gradient(135deg, #1A1A1A, #333); color: white; border-radius: 30px; padding: 25px; margin-top: 25px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); }

        .profile-luxe-card { background: white; border-radius: 40px; padding: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.02); overflow: hidden; position: relative; }
        .profile-luxe-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 120px; background: linear-gradient(to right, #6c5ce7, #a29bfe); opacity: 0.1; }
        .prof-avatar-luxe { width: 110px; height: 110px; border-radius: 35px; border: 5px solid white; box-shadow: 0 10px 30px rgba(108, 92, 231, 0.2); position: relative; z-index: 2; margin-top: 20px; transition: 0.5s; }
        .stat-pill { background: #f8f9fd; border-radius: 20px; padding: 15px; border: 1px solid rgba(0,0,0,0.02); }

        .poshak-card { background: white; border-radius: var(--radius-ultra); border: none; overflow: hidden; transition: var(--transition); height: 100%; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.02); opacity: 0; cursor: pointer; }
        .poshak-card.visible { opacity: 1; animation: fadeInUp 0.6s var(--transition); }
        .img-wrap { aspect-ratio: 1 / 1.15; overflow: hidden; background: #f0f2f5; }
        .img-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .price-tag { position: absolute; bottom: 15px; right: 15px; background: rgba(255,255,255,0.92); backdrop-filter: blur(10px); color: var(--accent); padding: 5px 12px; border-radius: 12px; font-weight: 800; font-size: 0.8rem; }
        .color-badge { position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.8); color: #444; padding: 2px 8px; border-radius: 6px; font-size: 0.6rem; font-weight: 700; z-index: 5; }
        .luxe-id-tag { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.6); color: white; padding: 2px 8px; border-radius: 6px; font-size: 0.6rem; font-weight: 700; z-index: 5; }

        .action-hub { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: var(--glass); backdrop-filter: blur(25px); padding: 10px 25px; border-radius: 100px; display: flex; gap: 15px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); z-index: 1000; border: 1px solid rgba(255,255,255,0.5); }
        .hub-btn { width: 48px; height: 48px; border-radius: 50%; border: none; background: #f1f2f6; color: var(--accent); transition: 0.3s; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .hub-btn.active { background: var(--accent); color: white; }

        .hidden { display: none !important; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes textShimmer { to { background-position: 200% center; } }
        @keyframes floatY { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    </style>
</head>
<body>
    <div class="aurora"></div>

    <nav class="navbar navbar-expand glass-nav">
        <div class="container d-flex justify-content-between align-items-center">
            <a class="navbar-brand" href="#" onclick="showSection('shop')">DivinePoshaks</a>
            <div class="d-flex align-items-center gap-3">
                <button id="loginBtn" class="btn btn-dark rounded-pill px-4 fw-800 btn-sm">Login</button>
                <img src="" id="userAvatar" class="hidden shadow-sm" onclick="showSection('profile')" style="width: 42px; height: 42px; border-radius: 14px; cursor: pointer; border: 2px solid var(--accent);">
            </div>
        </div>
    </nav>

    <main id="sectionShop" class="section-container container pb-5 mb-5">
        <header class="creative-greeting-wrap text-center">
            <div id="countdownBox" class="fest-countdown animate__animated animate__fadeIn">
                <div class="text-start ms-2"><small class="fw-bold d-block text-gold">NEAREST FESTIVAL</small><span id="cdEventName" class="small fw-800 text-white">...</span></div>
                <div class="d-flex gap-3 ms-auto">
                    <div class="text-center"><span class="cd-val" id="cdDays">00</span><span class="cd-lbl">Days</span></div>
                    <div class="text-center"><span class="cd-val" id="cdHrs">00</span><span class="cd-lbl">Hrs</span></div>
                    <div class="text-center"><span class="cd-val" id="cdMin">00</span><span class="cd-lbl">Min</span></div>
                </div>
            </div>
            <p id="timeGreeting" class="greet-text">Radhe Radhe!</p>
            <h1 id="userGreeting" class="user-name-shimmer">Divine Collections.</h1>
            
            <div class="search-container mt-4 animate__animated animate__fadeInUp">
                <i class="bi bi-search search-icon"></i>
                <input type="text" id="mainSearch" class="luxe-search" placeholder="Search by Name, Color or Luxe-ID (e.g. L-A1B2)..." oninput="handleSearch()">
            </div>
        </header>
        <div id="gallery" class="row g-3 g-md-4"></div>
    </main>

    <main id="sectionCalendar" class="section-container container hidden py-5 mb-5">
        <div class="text-center mb-5 animate__animated animate__fadeIn">
            <span class="badge bg-accent-soft text-accent rounded-pill px-3 py-2 mb-3 fw-800">Hindu Almanac 2026</span>
            <h1 class="fw-900 display-5">Divine Panchang</h1>
        </div>
        <div class="cal-container animate__animated animate__zoomIn">
            <div class="cal-header">
                <button class="cal-nav-btn" onclick="changeMonth(-1)"><i class="bi bi-chevron-left"></i></button>
                <h3 class="cal-month-title" id="monthDisplay">January</h3>
                <button class="cal-nav-btn" onclick="changeMonth(1)"><i class="bi bi-chevron-right"></i></button>
            </div>
            <div class="cal-grid" id="calGrid">
                <div class="cal-day-label">SUN</div><div class="cal-day-label">MON</div><div class="cal-day-label">TUE</div><div class="cal-day-label">WED</div><div class="cal-day-label">THU</div><div class="cal-day-label">FRI</div><div class="cal-day-label">SAT</div>
            </div>
        </div>
        <div style="max-width: 500px; margin: 0 auto;">
            <div class="insight-card animate__animated animate__fadeInUp">
                <h6 class="text-uppercase small fw-800 opacity-50 mb-2">Sacred Day Insight</h6>
                <h4 id="insightTitle" class="fw-900 mb-1">Select a Date</h4>
                <p id="insightDesc" class="small mb-0 opacity-75">Explore Hindu tithis and festive occasions.</p>
            </div>
        </div>
    </main>

    <main id="sectionAdmin" class="section-container container hidden py-4 mb-5">
        <div class="bg-white p-4 rounded-5 mb-3 shadow-sm" onclick="toggleCollapse('adminAddForm')">
            <h5 class="fw-900 mb-0" id="adminFormTitle">Add Product <i class="bi bi-chevron-down float-end"></i></h5>
            <div id="adminAddForm" class="mt-4 hidden" onclick="event.stopPropagation()">
                <div class="row g-2">
                    <input type="hidden" id="editProductId">
                    <input type="file" id="pImg" class="form-control mb-2 rounded-4">
                    <input type="text" id="pName" class="form-control mb-2 rounded-4" placeholder="Product Name">
                    <input type="number" id="pPrice" class="form-control mb-2 rounded-4" placeholder="Price (â‚¹)">
                    <input type="text" id="pColor" class="form-control mb-2 rounded-4" placeholder="Product Color (e.g. Saffron)">
                    <input type="text" id="pSize" class="form-control mb-2 rounded-4" placeholder="Product Size (e.g. 0, 1, 2)">
                    <button id="uploadBtn" class="btn btn-dark w-100 rounded-pill py-3 fw-800">PUBLISH</button>
                    <button id="cancelEditBtn" class="btn btn-light w-100 rounded-pill py-2 fw-800 mt-2 hidden" onclick="resetAdminForm()">CANCEL EDIT</button>
                </div>
            </div>
        </div>
        <div class="bg-white p-4 rounded-5 shadow-sm mt-3" onclick="toggleCollapse('adminInventoryList')">
            <h5 class="fw-900 mb-0">Manage Inventory <i class="bi bi-chevron-down float-end"></i></h5>
            <div id="adminInventoryList" class="mt-4 hidden" onclick="event.stopPropagation()">
                <div id="inventoryContainer"></div>
            </div>
        </div>
    </main>

    <main id="sectionProfile" class="section-container container hidden py-5 mb-5">
        <div class="profile-luxe-card animate__animated animate__fadeInUp">
            <div class="row align-items-center">
                <div class="col-md-4 text-center"><img src="" id="profImg" class="prof-avatar-luxe"></div>
                <div class="col-md-8 text-center text-md-start mt-4 mt-md-0">
                    <div id="profileView">
                        <span class="badge rounded-pill bg-accent-soft text-accent px-3 py-2 mb-2">Premium Devotee</span>
                        <h1 id="profName" class="fw-900 display-6 mb-1">Devotee</h1>
                        <p id="profEmail" class="text-muted mb-3 small"></p>
                        <button class="btn btn-sm btn-light rounded-pill px-3" onclick="toggleProfileEdit(true)"><i class="bi bi-pencil-square me-2"></i>Edit Profile</button>
                    </div>
                    <div id="profileEdit" class="hidden">
                        <input type="text" id="editName" class="form-control rounded-4 mb-2" placeholder="Your Name">
                        <div class="d-flex gap-2">
                            <button class="btn btn-dark rounded-pill px-4" onclick="saveProfile()">Save</button>
                            <button class="btn btn-light rounded-pill px-4" onclick="toggleProfileEdit(false)">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row g-3 mt-5">
                <div class="col-4"><div class="stat-pill text-center"><h4 class="fw-900 mb-0" id="billCount">0</h4><small class="fw-800">Bills</small></div></div>
                <div class="col-4"><div class="stat-pill text-center"><h4 class="fw-900 mb-0 text-success">850</h4><small class="fw-800">Points</small></div></div>
                <div class="col-4"><div class="stat-pill text-center"><h4 class="fw-900 mb-0 text-warning">Gold</h4><small class="fw-800">Tier</small></div></div>
            </div>
        </div>
        <button id="logoutBtn" class="btn btn-outline-danger w-100 rounded-pill py-3 mt-5 fw-800 border-0 bg-white">LOG OUT</button>
    </main>

    <div class="action-hub">
        <button class="hub-btn active" id="hubShop" onclick="showSection('shop')"><i class="fa fa-house-chimney"></i></button>
        <button class="hub-btn" id="hubCalendar" onclick="showSection('calendar')"><i class="bi bi-calendar2-range"></i></button>
        <button class="hub-btn hidden" id="hubAdmin" onclick="showSection('admin')"><i class="bi bi-shield-lock"></i></button>
        <button class="hub-btn hidden" id="hubProfile" onclick="showSection('profile')"><i class="fa fa-user-circle"></i></button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBTRwFyTODsIj5kPm6Tw0ppdHrBBvYP0a4",
            authDomain: "shop-c8a3f.firebaseapp.com",
            databaseURL: "https://shop-c8a3f-default-rtdb.firebaseio.com",
            projectId: "shop-c8a3f",
            storageBucket: "shop-c8a3f.firebasestorage.app"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);
        const provider = new GoogleAuthProvider();
        const adminEmail = "anuradhagoel851@gmail.com";
        const whatsappNumber = "917206279351";

        // Global product storage for search
        let currentProducts = [];

        window.openWhatsApp = (name, price, color, size, id) => {
            const luxeId = id.slice(-4).toUpperCase();
            const msg = encodeURIComponent(`Radhe Radhe! I'm interested in:\n\nâœ¨ Poshak: ${name}\nðŸ†” ID: L-${luxeId}\nðŸ’° Price: â‚¹${price}\nðŸŽ¨ Color: ${color || 'Standard'}\nðŸ“ Size: ${size || 'N/A'}`);
            window.open(`https://wa.me/${whatsappNumber}?text=${msg}`, '_blank');
        };

        const sacredDays = { "2-15": "Maha Shivaratri", "3-4": "Holi", "3-27": "Rama Navami", "4-2": "Hanuman Jayanti", "8-28": "Raksha Bandhan", "9-4": "Krishna Janmashtami", "10-21": "Vijayadashami", "11-8": "Diwali" };

        function runTimer() {
            const now = new Date(); const year = 2026; let target = null; let eventName = "";
            for (const [key, name] of Object.entries(sacredDays)) {
                const [m, d] = key.split('-'); const eventDate = new Date(year, m - 1, d);
                if (eventDate > now) { if (!target || eventDate < target) { target = eventDate; eventName = name; } }
            }
            if (!target) return;
            document.getElementById('cdEventName').innerText = eventName;
            setInterval(() => {
                const diff = target.getTime() - new Date().getTime();
                document.getElementById('cdDays').innerText = Math.floor(diff / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
                document.getElementById('cdHrs').innerText = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                document.getElementById('cdMin').innerText = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
            }, 1000);
        }
        runTimer();

        window.editProduct = (id) => {
            onValue(ref(db, `products/${id}`), (snap) => {
                const p = snap.val();
                if(p) {
                    document.getElementById('adminFormTitle').innerHTML = `Edit Product: ${p.name} <i class="bi bi-chevron-down float-end"></i>`;
                    document.getElementById('editProductId').value = id;
                    document.getElementById('pName').value = p.name;
                    document.getElementById('pPrice').value = p.price;
                    document.getElementById('pColor').value = p.color || "";
                    document.getElementById('pSize').value = p.size || "";
                    document.getElementById('uploadBtn').innerText = "UPDATE PRODUCT";
                    document.getElementById('cancelEditBtn').classList.remove('hidden');
                    document.getElementById('adminAddForm').classList.remove('hidden');
                    window.scrollTo(0,0);
                }
            }, { onlyOnce: true });
        };

        window.resetAdminForm = () => {
            document.getElementById('adminFormTitle').innerHTML = `Add Product <i class="bi bi-chevron-down float-end"></i>`;
            document.getElementById('editProductId').value = '';
            document.getElementById('pName').value = '';
            document.getElementById('pPrice').value = '';
            document.getElementById('pColor').value = '';
            document.getElementById('pSize').value = '';
            document.getElementById('pImg').value = '';
            document.getElementById('uploadBtn').innerText = "PUBLISH";
            document.getElementById('cancelEditBtn').classList.add('hidden');
        };

        document.getElementById('uploadBtn').onclick = () => {
            const file = document.getElementById('pImg').files[0];
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const color = document.getElementById('pColor').value;
            const size = document.getElementById('pSize').value;
            const editId = document.getElementById('editProductId').value;
            if (!name || !price) return alert("Fill Name and Price.");
            const process = (imgUrl = null) => {
                const d = { name, price, color, size };
                if(imgUrl) d.url = imgUrl;
                if(editId) update(ref(db, `products/${editId}`), d).then(() => resetAdminForm());
                else push(ref(db, 'products'), d).then(() => resetAdminForm());
            };
            if (file) { const r = new FileReader(); r.readAsDataURL(file); r.onload = () => process(r.result); }
            else process();
        };

        window.deleteProduct = (id) => { if(confirm("Remove Poshak?")) remove(ref(db, `products/${id}`)); };

        window.handleSearch = () => {
            const term = document.getElementById('mainSearch').value.toLowerCase();
            renderGallery(currentProducts.filter(p => 
                p.name.toLowerCase().includes(term) || 
                (p.color && p.color.toLowerCase().includes(term)) || 
                (p.size && p.size.toLowerCase().includes(term)) ||
                `l-${p.id.slice(-4).toUpperCase()}`.toLowerCase().includes(term)
            ));
        };

        function renderGallery(products) {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';
            products.forEach(p => {
                const luxeId = p.id.slice(-4).toUpperCase();
                gallery.innerHTML += `
                    <div class="col-6 col-md-4 col-lg-3">
                        <div class="poshak-card shadow-sm visible" onclick="openWhatsApp('${p.name}', '${p.price}', '${p.color}', '${p.size}', '${p.id}')">
                            <span class="luxe-id-tag">L-${luxeId}</span>
                            ${p.color ? `<span class="color-badge">${p.color}</span>` : ''}
                            <div class="img-wrap"><img src="${p.url}"></div>
                            <div class="p-2 text-center small fw-bold">
                                ${p.name}<br>
                                <span class="text-primary">â‚¹${p.price}</span>
                                ${p.size ? `<div class="text-muted mt-1" style="font-size: 0.6rem">Size: ${p.size}</div>` : ''}
                            </div>
                        </div>
                    </div>`;
            });
        }

        window.toggleProfileEdit = (show) => {
            document.getElementById('profileView').classList.toggle('hidden', show);
            document.getElementById('profileEdit').classList.toggle('hidden', !show);
            if(show) document.getElementById('editName').value = document.getElementById('profName').innerText;
        };

        window.saveProfile = async () => {
            const user = auth.currentUser;
            const newName = document.getElementById('editName').value;
            if(user && newName) {
                await update(ref(db, `users/${user.uid}`), { name: newName });
                toggleProfileEdit(false);
            }
        };

        window.toggleCollapse = (id) => document.getElementById(id).classList.toggle('hidden');

        let vMonth = new Date().getMonth(); let vYear = 2026;
        function renderCal() {
            const grid = document.getElementById('calGrid');
            const monthText = document.getElementById('monthDisplay');
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            monthText.innerText = monthNames[vMonth];
            const labels = Array.from(grid.querySelectorAll('.cal-day-label'));
            grid.innerHTML = ''; labels.forEach(l => grid.appendChild(l));
            const firstDay = new Date(vYear, vMonth, 1).getDay();
            const daysInMonth = new Date(vYear, vMonth + 1, 0).getDate();
            for (let i = 0; i < firstDay; i++) grid.appendChild(document.createElement('div'));
            for (let d = 1; d <= daysInMonth; d++) {
                const dateDiv = document.createElement('div'); dateDiv.className = 'cal-date'; dateDiv.innerText = d;
                const dateKey = `${vMonth + 1}-${d}`; const festival = sacredDays[dateKey];
                if (festival) { dateDiv.classList.add('sacred'); dateDiv.innerHTML += `<div class="fest-indicator"></div>`; }
                if (new Date().toDateString() === new Date(vYear, vMonth, d).toDateString()) dateDiv.classList.add('today');
                dateDiv.onclick = () => {
                    document.querySelectorAll('.cal-date').forEach(el => el.classList.remove('selected'));
                    dateDiv.classList.add('selected');
                    updateInsight(d, vMonth, festival);
                };
                grid.appendChild(dateDiv);
            }
        }
        window.changeMonth = (dir) => { vMonth += dir; if (vMonth < 0) vMonth = 11; if (vMonth > 11) vMonth = 0; renderCal(); };
        function updateInsight(day, month, fest) {
            const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            document.getElementById('insightTitle').innerText = `${day} ${months[month]}`;
            document.getElementById('insightDesc').innerText = fest ? `Sacred Event: ${fest}` : "An auspicious day for Divine Devotion.";
        }
        renderCal();

        window.showSection = (n) => {
            document.querySelectorAll('.section-container').forEach(s => s.classList.add('hidden'));
            const target = document.getElementById(`section${n.charAt(0).toUpperCase() + n.slice(1)}`);
            if(target) target.classList.remove('hidden');
            document.querySelectorAll('.hub-btn').forEach(b => b.classList.remove('active'));
            const b = document.getElementById(`hub${n.charAt(0).toUpperCase() + n.slice(1)}`);
            if(b) b.classList.add('active');
        };

        onAuthStateChanged(auth, user => {
            if (user) {
                document.getElementById('loginBtn').classList.add('hidden');
                document.getElementById('userAvatar').classList.remove('hidden');
                document.getElementById('userAvatar').src = user.photoURL;
                document.getElementById('profImg').src = user.photoURL;
                document.getElementById('hubProfile').classList.remove('hidden');
                if (user.email === adminEmail) document.getElementById('hubAdmin').classList.remove('hidden');
                onValue(ref(db, `users/${user.uid}`), s => {
                    const d = s.val() || {}; const name = d.name || user.displayName;
                    document.getElementById('profName').innerText = name;
                    document.getElementById('profEmail').innerText = user.email;
                    updateGreeting(name);
                });
            } else {
                document.getElementById('loginBtn').classList.remove('hidden');
                document.getElementById('userAvatar').classList.add('hidden');
                document.getElementById('hubAdmin').classList.add('hidden');
                document.getElementById('hubProfile').classList.add('hidden');
                updateGreeting(null);
            }
        });

        function updateGreeting(n) {
            const hr = new Date().getHours(); let g = hr<12?"Good Morning":hr<17?"Good Afternoon":"Good Evening";
            document.getElementById('timeGreeting').innerText = n ? `${g},` : "Radhe Radhe,";
            document.getElementById('userGreeting').innerText = n ? `${n}.` : "Divine Boutique.";
        }

        onValue(ref(db, 'products'), snap => {
            const inventory = document.getElementById('inventoryContainer');
            inventory.innerHTML = '';
            currentProducts = snap.val() ? Object.entries(snap.val()).map(([id, p]) => ({ id, ...p })) : [];
            
            renderGallery(currentProducts);

            currentProducts.forEach(p => {
                const luxeId = p.id.slice(-4).toUpperCase();
                inventory.innerHTML += `
                    <div class="d-flex align-items-center justify-content-between p-3 border-bottom">
                        <div class="d-flex align-items-center gap-3">
                            <img src="${p.url}" style="width: 50px; height: 50px; border-radius: 10px; object-fit: cover;">
                            <div><h6 class="mb-0 fw-800">${p.name} <small class="text-muted">(L-${luxeId})</small></h6><small class="text-muted">â‚¹${p.price} | ${p.color || 'No Color'} | Size: ${p.size || 'N/A'}</small></div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary border-0" onclick="editProduct('${p.id}')"><i class="bi bi-pencil"></i></button>
                            <button class="btn btn-sm btn-outline-danger border-0" onclick="deleteProduct('${p.id}')"><i class="bi bi-trash"></i></button>
                        </div>
                    </div>`;
            });
        });
        
        document.getElementById('loginBtn').onclick = () => signInWithPopup(auth, provider);
        document.getElementById('logoutBtn').onclick = () => signOut(auth);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
